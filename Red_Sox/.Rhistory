)
# Function to extract and plot coefficients
plot_model_coefficients <- function(model, model_name) {
# Extract coefficients from the model
coefficients <- summary(model)$coefficients
# Filter coefficients to include only those related to the dummy variables D_1, D_2, ..., D_13
D_coefficients <- coefficients[grep("^D_", rownames(coefficients)), ]
# Create a data frame with the coefficients and their corresponding dummy variable names
D_coefficients_df <- data.frame(
Dummy = rownames(D_coefficients),
Coefficient = D_coefficients[, "Estimate"],
StdError = D_coefficients[, "Std. Error"],
Model = model_name
)
# Convert Dummy to a factor with levels ordered accordingly and then reverse the levels
D_coefficients_df$Dummy <- factor(D_coefficients_df$Dummy, levels = rev(paste0("D_", 1:13)))
return(D_coefficients_df)
}
# Extract coefficients for the models
coefficients_2009 <- plot_model_coefficients(model_2009, "2009")
coefficients_2010 <- plot_model_coefficients(model_2010, "2010")
coefficients_2011 <- plot_model_coefficients(model_2011, "2011")
coefficients_2012 <- plot_model_coefficients(model_2012, "2012")
# Combine all coefficients into one data frame
all_coefficients_df <- bind_rows(coefficients_2009, coefficients_2010, coefficients_2011, coefficients_2012)
# Plot the coefficients using ggplot2
ggplot(all_coefficients_df, aes(x = Dummy, y = Coefficient, color = Model)) +
geom_point() +
geom_errorbar(aes(ymin = Coefficient - 1.96 * StdError, ymax = Coefficient + 1.96 * StdError), width = 0.2) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(title = "Coefficients of Dummy Variables (Days from Transaction Until Game) on Ticket Price", x = "Dummy Variable", y = "Coefficient") +
facet_wrap(~ Model, scales = "free_y")
install.packages("tabulate")
install.packages("tabulate")
install.packages("tabulate")
gc()
# Load necessary library
library(readr)
# Read the CSV file
data <- read_csv("C:/Users/clint/Desktop/Coding Task Darthmouth/lottery_study/lottery_study/lottery_study_updated.csv")
# Convert categorical variables to factors if they are not already
data$black <- as.factor(data$black)
data$hispanic <- as.factor(data$hispanic)
data$white <- as.factor(data$white)
data$gender <- as.factor(data$gender)
data$urban <- as.factor(data$urban)
data$employment <- as.factor(data$employment)
data$religion <- as.factor(data$religion)
data$state <- as.factor(data$state)
# Define the regression model
model <- lm(
lottery_expenditure ~ income +
black + hispanic + white +
gender + marital_status +
urban + employment +
religion + education +
ideology + state +
not_working_age + early_working_age +
late_working_age + retired,
data = data
)
# Load necessary library
library(readr)
# Read the CSV file
data <- read_csv("C:/Users/clint/Desktop/Coding Task Darthmouth/lottery_study/lottery_study/lottery_study_updated.csv")
# Convert categorical variables to factors if they are not already
data$black <- as.factor(data$black)
data$hispanic <- as.factor(data$hispanic)
data$white <- as.factor(data$white)
data$gender <- as.factor(data$gender)
data$urban <- as.factor(data$urban)
data$employment <- as.factor(data$employment)
data$religion <- as.factor(data$religion)
data$state <- as.factor(data$state)
# Define the regression model
model <- lm(
expend_total ~ income +
black + hispanic + white +
gender + marital_status +
urban + employment +
religion + education +
ideology + state +
not_working_age + early_working_age +
late_working_age + retired,
data = data
)
# Load necessary library
library(readr)
# Read the CSV file
data <- read_csv("C:/Users/clint/Desktop/Coding Task Darthmouth/lottery_study/lottery_study/lottery_study_updated.csv")
# Convert categorical variables to factors if they are not already
data$black <- as.factor(data$black)
data$hispanic <- as.factor(data$hispanic)
data$white <- as.factor(data$white)
data$gender <- as.factor(data$gender)
data$urban <- as.factor(data$urban)
data$employment <- as.factor(data$employment)
data$religion <- as.factor(data$religion)
data$state <- as.factor(data$state)
data$marital <- as.factor(data$marital)  # Convert marital status to factor
# Define the regression model
model <- lm(
expend_total ~ income +
black + hispanic + white +
gender + marital +  # Include marital as a categorical variable
urban + employment +
religion + education +
ideology + state +
not_working_age + early_working_age +
late_working_age + retired,
data = data
)
# View the summary of the regression model
summary(model)
# Load necessary libraries
library(readr)
library(stargazer)
# Read the CSV file
data <- read_csv("C:/Users/clint/Desktop/Coding Task Darthmouth/lottery_study/lottery_study/lottery_study_updated.csv")
# Convert categorical variables to factors if they are not already
data$black <- as.factor(data$black)
data$hispanic <- as.factor(data$hispanic)
data$white <- as.factor(data$white)
data$gender <- as.factor(data$gender)
data$urban <- as.factor(data$urban)
data$employment <- as.factor(data$employment)
data$religion <- as.factor(data$religion)
data$state <- as.factor(data$state)
data$marital <- as.factor(data$marital)  # Convert marital status to factor
# Define the regression model
model <- lm(
expend_total ~ income +
black + hispanic + white +
gender + marital +
urban + employment +
religion + education +
ideology + state +
not_working_age + early_working_age +
late_working_age + retired,
data = data
)
# Create HTML output using stargazer
stargazer(model, type = "html",
title = "Regression Results",
out = "C:/Users/clint/Desktop/lottery_regression_results.html",
align = TRUE,
no.space = TRUE)
# Load necessary libraries
library(readr)
library(stargazer)
# Read the CSV file
data <- read_csv("C:/Users/clint/Desktop/Coding Task Darthmouth/lottery_study/lottery_study/lottery_study_updated.csv")
# Convert categorical variables to factors if they are not already
data$black <- as.factor(data$black)
data$hispanic <- as.factor(data$hispanic)
data$white <- as.factor(data$white)
data$gender <- as.factor(data$gender)
data$urban <- as.factor(data$urban)
data$employment <- as.factor(data$employment)
data$religion <- as.factor(data$religion)
data$state <- as.factor(data$state)
data$marital <- as.factor(data$marital)  # Convert marital status to factor
# Define the regression model
model <- lm(
expend_total ~ income +
black + hispanic + white +
gender + marital +
urban + employment +
religion + education +
ideology + state +
not_working_age + early_working_age +
late_working_age + retired,
data = data
)
# Create HTML output using stargazer
stargazer(model, type = "html",
title = "Regression Results",
out = "C:/Users/clint/Desktop/lottery_regression_results.html",
align = TRUE,
no.space = TRUE)
# Load necessary libraries
library(readr)
library(stargazer)
# Read the CSV file
data <- read_csv("C:/Users/clint/Desktop/Coding Task Darthmouth/lottery_study/lottery_study/lottery_study_updated.csv")
# Convert categorical variables to factors if they are not already
data$black <- as.factor(data$black)
data$hispanic <- as.factor(data$hispanic)
data$white <- as.factor(data$white)
data$gender <- as.factor(data$gender)
data$urban <- as.factor(data$urban)
data$employment <- as.factor(data$employment)
data$religion <- as.factor(data$religion)
data$state <- as.factor(data$state)
data$marital <- as.factor(data$marital)  # Convert marital status to factor
# Define the regression model
model <- lm(
expend_total ~ income +
black + hispanic + white +
gender + marital +
urban + employment +
religion + education +
ideology + state +
not_working_age + early_working_age +
late_working_age + retired,
data = data
)
# Create HTML output using stargazer
stargazer(model, type = "html",
title = "Regression Results",
out = "C:/Users/clint/Desktop/Coding Task Darthmouth/lottery_study/lottery_regression_results.html",
align = TRUE,
no.space = TRUE)
# Load necessary libraries
library(readr)
library(stargazer)
# Read the CSV file
data <- read_csv("C:/Users/clint/Desktop/Coding Task Darthmouth/lottery_study/lottery_study/lottery_study_updated.csv")
# Convert categorical variables to factors if they are not already
data$black <- as.factor(data$black)
data$hispanic <- as.factor(data$hispanic)
data$white <- as.factor(data$white)
data$gender <- as.factor(data$gender)
data$urban <- as.factor(data$urban)
data$employment <- as.factor(data$employment)
data$religion <- as.factor(data$religion)
data$state <- as.factor(data$state)
data$marital <- as.factor(data$marital)  # Convert marital status to factor
# Define the regression model
model <- lm(
expend_total ~ income +
black + hispanic + white +
gender + marital +
urban + employment +
religion + education +
ideology + state +
not_working_age + early_working_age +
late_working_age + retired,
data = data
)
# Create HTML output using stargazer, excluding state variables from the table
stargazer(model, type = "html",
title = "Regression Results",
out = "C:/Users/clint/Desktop/lottery_regression_results.html",
align = TRUE,
no.space = TRUE,
omit = "state",
add.lines = list(c("State variables", "Yes")))
# Load necessary libraries
library(readr)
library(stargazer)
# Read the CSV file
data <- read_csv("C:/Users/clint/Desktop/Coding Task Darthmouth/lottery_study/lottery_study/lottery_study_updated.csv")
# Convert categorical variables to factors if they are not already
data$black <- as.factor(data$black)
data$hispanic <- as.factor(data$hispanic)
data$white <- as.factor(data$white)
data$gender <- as.factor(data$gender)
data$urban <- as.factor(data$urban)
data$employment <- as.factor(data$employment)
data$religion <- as.factor(data$religion)
data$state <- as.factor(data$state)
data$marital <- as.factor(data$marital)  # Convert marital status to factor
# Define the regression model
model <- lm(
expend_total ~ income +
black + hispanic + white +
gender + marital +
urban + employment +
religion + education +
ideology + state +
not_working_age + early_working_age +
late_working_age + retired,
data = data
)
# Create HTML output using stargazer
targazer(model, type = "html",
title = "Regression Results",
out = "C:/Users/clint/Desktop/Coding Task Darthmouth/lottery_study/lottery_regression_results.html",
align = TRUE,
no.space = TRUE,
omit = "state",  # Omit state controls
add.lines = list(c("State controls", "Yes"))  # Indicate state controls
)
# Load necessary libraries
library(readr)
library(stargazer)
# Read the CSV file
data <- read_csv("C:/Users/clint/Desktop/Coding Task Darthmouth/lottery_study/lottery_study/lottery_study_updated.csv")
# Convert categorical variables to factors if they are not already
data$black <- as.factor(data$black)
data$hispanic <- as.factor(data$hispanic)
data$white <- as.factor(data$white)
data$gender <- as.factor(data$gender)
data$urban <- as.factor(data$urban)
data$employment <- as.factor(data$employment)
data$religion <- as.factor(data$religion)
data$state <- as.factor(data$state)
data$marital <- as.factor(data$marital)  # Convert marital status to factor
# Define the regression model
model <- lm(
expend_total ~ income +
black + hispanic + white +
gender + marital +
urban + employment +
religion + education +
ideology + state +
not_working_age + early_working_age +
late_working_age + retired,
data = data
)
# Create HTML output using stargazer
stargazer(model, type = "html",
title = "Regression Results",
out = "C:/Users/clint/Desktop/Coding Task Darthmouth/lottery_study/lottery_regression_results.html",
align = TRUE,
no.space = TRUE,
omit = "state",  # Omit state controls
add.lines = list(c("State controls", "Yes"))  # Indicate state controls
)
# Create HTML output using stargazer for both models side by side
stargazer(model, simple_model, type = "html",
title = "Regression Results",
out = "C:/Users/clint/Desktop/Coding Task Darthmouth/lottery_study/lottery_regression_results_side_by_side.html",
align = TRUE,
no.space = TRUE,
omit = "state",  # Omit state controls for the first model
add.lines = list(c("State controls", "Yes", "No"))  # Indicate state controls for both models
)
# Load necessary libraries
library(readr)
library(stargazer)
# Read the CSV file
data <- read_csv("C:/Users/clint/Desktop/Coding Task Darthmouth/lottery_study/lottery_study/lottery_study_updated.csv")
# Convert categorical variables to factors if they are not already
data$black <- as.factor(data$black)
data$hispanic <- as.factor(data$hispanic)
data$white <- as.factor(data$white)
data$gender <- as.factor(data$gender)
data$urban <- as.factor(data$urban)
data$employment <- as.factor(data$employment)
data$religion <- as.factor(data$religion)
data$state <- as.factor(data$state)
data$marital <- as.factor(data$marital)  # Convert marital status to factor
# Define the regression model
model <- lm(
expend_total ~ income +
black + hispanic + white +
gender + marital +
urban + employment +
religion + education +
ideology + state +
not_working_age + early_working_age +
late_working_age + retired,
data = data
)
# Load necessary libraries
library(readr)
library(stargazer)
# Read the CSV file
data <- read_csv("C:/Users/clint/Desktop/Coding Task Darthmouth/lottery_study/lottery_study/lottery_study_updated.csv")
# Convert categorical variables to factors if they are not already
data$black <- as.factor(data$black)
data$hispanic <- as.factor(data$hispanic)
data$white <- as.factor(data$white)
data$gender <- as.factor(data$gender)
data$urban <- as.factor(data$urban)
data$employment <- as.factor(data$employment)
data$religion <- as.factor(data$religion)
data$state <- as.factor(data$state)
data$marital <- as.factor(data$marital)  # Convert marital status to factor
# Define the regression model
model <- lm(
expend_total ~ income +
black + hispanic + white +
gender + marital +
urban + employment +
religion + education +
ideology + state +
not_working_age + early_working_age +
late_working_age + retired,
data = data
)
# Load necessary libraries
library(readr)
library(stargazer)
# Read the CSV file
data <- read_csv("C:/Users/clint/Desktop/Coding Task Darthmouth/lottery_study/lottery_study/lottery_study_updated.csv")
# Convert categorical variables to factors if they are not already
data$black <- as.factor(data$black)
data$hispanic <- as.factor(data$hispanic)
data$white <- as.factor(data$white)
data$gender <- as.factor(data$gender)
data$urban <- as.factor(data$urban)
data$employment <- as.factor(data$employment)
data$religion <- as.factor(data$religion)
data$state <- as.factor(data$state)
data$marital <- as.factor(data$marital)  # Convert marital status to factor
# Define the regression model
model <- lm(
expend_total ~ income +
black + hispanic + white +
gender + marital +
urban + employment +
religion + education +
ideology + state +
not_working_age + early_working_age +
late_working_age + retired,
data = data
)
# ...existing code...
# Check for factors with only one level and remove them
factor_vars <- c("black", "hispanic", "white", "gender", "urban", "employment", "religion", "state", "marital")
for (var in factor_vars) {
if (length(unique(data[[var]])) < 2) {
data[[var]] <- NULL
}
}
# Define the original regression model
model <- lm(
expend_total ~ income +
black + hispanic + white +
gender + marital +
urban + employment +
religion + education +
ideology + state +
not_working_age + early_working_age +
late_working_age + retired,
data = data
)
# Load necessary libraries
library(readr)
library(stargazer)
# Read the CSV file
data <- read_csv("C:/Users/clint/Desktop/Coding Task Darthmouth/lottery_study/lottery_study/lottery_study_updated.csv")
# Convert categorical variables to factors if they are not already
data$black <- as.factor(data$black)
data$hispanic <- as.factor(data$hispanic)
data$white <- as.factor(data$white)
data$gender <- as.factor(data$gender)
data$urban <- as.factor(data$urban)
data$employment <- as.factor(data$employment)
data$religion <- as.factor(data$religion)
data$state <- as.factor(data$state)
data$marital <- as.factor(data$marital)  # Convert marital status to factor
# Define the regression model
model <- lm(
expend_total ~ income +
black + hispanic + white +
gender + marital +
urban + employment +
religion + education +
ideology + state +
not_working_age + early_working_age +
late_working_age + retired,
data = data
)
# Load necessary libraries
library(readr)
library(stargazer)
# Read the CSV file
data <- read_csv("C:/Users/clint/Desktop/Coding Task Darthmouth/lottery_study/lottery_study/lottery_study_updated.csv")
# Convert categorical variables to factors if they are not already
data$black <- as.factor(data$black)
data$hispanic <- as.factor(data$hispanic)
data$white <- as.factor(data$white)
data$gender <- as.factor(data$gender)
data$urban <- as.factor(data$urban)
data$employment <- as.factor(data$employment)
data$religion <- as.factor(data$religion)
data$state <- as.factor(data$state)
data$marital <- as.factor(data$marital)  # Convert marital status to factor
# Define the regression model
model <- lm(
expend_total ~ income +
black + hispanic + white +
gender + marital +
urban + employment +
religion + education +
ideology + state +
not_working_age + early_working_age +
late_working_age + retired,
data = data
)
gc()
# Load necessary libraries
library(readr)
library(stargazer)
# Read the CSV file
data <- read_csv("C:/Users/clint/Desktop/Coding Task Darthmouth/lottery_study/lottery_study/lottery_study_updated.csv")
# Convert categorical variables to factors if they are not already
data$black <- as.factor(data$black)
data$hispanic <- as.factor(data$hispanic)
data$white <- as.factor(data$white)
data$gender <- as.factor(data$gender)
data$urban <- as.factor(data$urban)
data$employment <- as.factor(data$employment)
data$religion <- as.factor(data$religion)
data$state <- as.factor(data$state)
data$marital <- as.factor(data$marital)  # Convert marital status to factor
# Define the regression model
model <- lm(
expend_total ~ income +
black + hispanic + white +
gender + marital +
urban + employment +
religion + education +
ideology + state +
not_working_age + early_working_age +
late_working_age + retired,
data = data
)
